<script type='text/javascript'>
  $(document).ready(function() {
    elements = [
      '#available_course_coordinator_id',
      '#available_course_course_id',
      '#available_course_curriculum_id',
      '#available_course_unit_id',
    ]

    $(elements.join(',')).select2();

    var parameters = [
      {
        el: '#available_course_unit_id',
        target: '#available_course_curriculum_id',
        params: { 'unit_id': '#available_course_unit_id' },
        source: '/units/:unit_id/curriculums/',
        reset_selectors: '#available_course_curriculum_id, #available_course_course_id',
        placeholder: 'Müfredat Seçiniz'
      },
      {
        el: '#available_course_unit_id',
        target: '#group_lecturer_id',
        params: { 'unit_id': '#available_course_unit_id' },
        source: '/units/:unit_id/employees/',
        label_attribute: 'full_name',
        reset_selectors: '#group_lecturer_id',
        placeholder: 'Öğretim Elemanını Seçiniz'
      },
      {
        el: '#available_course_curriculum_id',
        target: '#available_course_course_id',
        params: { 'curriculum_id': '#available_course_curriculum_id' },
        source: '/curriculums/:curriculum_id/openable_courses',
        reset_selectors: '#available_course_course_id',
        placeholder: 'Ders Seçiniz'
      },
      {
        el: '#available_course_unit_id',
        target: '#available_course_coordinator_id',
        params: { 'unit_id': '#available_course_unit_id' },
        source: '/units/:unit_id/employees/',
        label_attribute: 'full_name',
        reset_selectors: '#available_course_coordinator_id',
        placeholder: 'Koordinatör Seçiniz'
      }
    ]
    var dynamic_select = new DynamicSelect(parameters)
    dynamic_select.init()

    configure_link_to_remove()

    function configure_link_to_remove() {
      if ($('#groups.nested-fields:visible').length == 1) {
        $('#groups.card-footer:visible').hide();
      } else {
        $('#groups.card-footer:hidden').show();
      }
    }

    $('#groups').on('cocoon:after-insert cocoon:after-remove', function() {
      configure_link_to_remove()
    });
  });
</script>
